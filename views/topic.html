<% $.master("./layout/master.html") %> 
    
<% $.placeBegin("head") %>
    <title>话题 | <%= $.seo.name %></title>
    <meta name="keywords" content="<%= $.seo.keywords %>"/>
    <meta name="description" content="<%= $.seo.description %>"/>
    <meta name="author" content="<%= $.seo.author %>"/>
<% $.placeEnd() >

<% $.placeBegin("content") %>

<div class="panel panel-default">
    <div class="panel-heading">
        <a class="tab <%= this.currentType=='all'?'active':'' %>" href="/topic">所有</a>
        <% $.each(this.types,function(i,item){ %>
        <a class="tab <%= this.currentType==item.name?'active':'' %>" href="/topic/<%= item.name %>/page/1">
            <%= item.text %>
        </a>
        <% }.bind(this)) %>
    </div>
    <div class="panel-body">
        <% if(this.list &&　this.list.length>0){ %>
        <ul class="media-list topic-list">
            <% $.each(this.list,function(i,item){ %>
            <li class="media">
                <a class="media-left" href="/user/<%= item.author.id %>">
                    <img class="media-object avatar" src="<%= item.author.avatar %>" alt="<%= item.author.name %>">
                </a>
                <div class="media-body">
                    <h4 class="media-heading">
                        <a href="/topic/<%= item.id %>"><%= item.title %></a>
                    </h4>
                    <span class="topic-info">
                        <a href="/user/<%= item.author.id %>"><%= item.author.name %></a> 
                        发布于 
                        <span title="<%= $.formatDate(item.createAt,'yyyy-MM-dd hh:mm') %>">
                            <%= $.timeago(item.createAt) %>
                        </span> , 
                        <% if(item.lastReplayAuthor){ %>
                            <a href="/user/<%= item.lastReplayAuthor.id %>">
                                <%= item.lastReplayAuthor.name %>
                            </a>
                            回复于 
                            <span title="<%= $.formatDate(item.lastReplayAt,'yyyy-MM-dd hh:mm') %>">
                                <%= $.timeago(item.lastReplayAt) %>
                           </span>
                        <% }else{ %>
                            无人回复
                        <% } %>
                    </span>
                </div>
                <div class="media-right">
                    <a href="/topic/<%= item.id %>#comments">
                        <span class="badge"><%= item.replay %>/<%= item.read %></span>
                    </a>
                </div>
            </li>
            <% }.bind(this)); %>
        </ul>
        <% }else{ %>
        <p class="topic-empty">没有话题</p>
        <% } %>
    </div>
    <div class="panel-footer">
        <ul class="pagination">
            <li>
            <a href="/topic/<%= this.currentType %>/page/1" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
            </li>
            <% for(var i=this.pageBegin;i<=this.pageEnd;i++){ %>
            <li class="<%= this.pageIndex==i?'active':'' %>">
                <a href="/topic/<%= this.currentType %>/page/<%= i %>"><%= i %></a>
            </li>
            <% } %>
            <li>
            <a href="/topic/<%= this.currentType %>/page/<%= this.pageCount||1 %>" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
            </li>
        </ul>
    </div>
</div>

<% $.placeEnd() %>